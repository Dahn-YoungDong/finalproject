---
title: "Minimum viable analysis"
author: "Dahn-Young Dong"
date: "10/22/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Mimimum Viable Analysis

I: Use program TreeMix to make inference of patterns of population splitting and mixing from genomewide allele frequency data (over Linux Shell bash either locally or HPC grace to understand gene flow directions of populations)

Source for the documentation and download of treemix https://bitbucket.org/nygcresearch/treemix/downloads/
script example by github contributor https://github.com/jbv2/nf-vcf2treemix

II: Spatially visualizing genetic clusters with maps of population admixture coefficients

Follow the scripts from https://github.com/jdalapicolla/LanGen_pipeline_version2, the ones related to manipulating and visualizing genetic data given spatial coordinates--- 1.1 filtering SNPS, 1.2 genetic structure, 1.3 Maps.

All the work should be done over R and Rstudio
-----
Notes for Instructors: 

For I: 

I have tried running TreeMix on my local computer but too many dependencies I have not downloaded and I hit trouble running proper version of Java when I was installing Nextflow which runs vcf2treemix 

I tried running TreeMix over Yale HPC Grace but it returned error

EnvironmentNotWritableError: The current user does not have write permissions to the target environment.
  environment location: /gpfs/loomis/apps/avx/software/miniconda/4.8.3
  uid: 17242
  gid: 11199
  
For II: I am figuring out how to use regular expression to match the sample names in order to run the pipeline. 

### Spatially visualizing genetic clusters with maps of population admixture coefficients

```{r}
# THE FILE ".CSV" WITH THE GEOGRAPHICAL INFORMATION OF GENETIC SAMPLES IN DECIMALS DEGREES PREFERENCIALLY AND ONE COLUMN WITH LOCALITIES IDs. DIFFERENT INDIVIDUALS MUST HAVE DIFFERENT COORDINATES. IF TWO OR MORE SAMPLES WERE COLLECTED IN THE SAME LOCALITY, CHANGE THE VALUE OF 4TH OR 5TH DECIMAL NUMBER TO SET A DIFFERENCE OF 1 OR 5 METERS. SOME ANALYSES COULD RETURN ERRORS IF THE DIFFERENCES IN METERS BETWEEN INDIVIDUALS IS 0. -- somehow jitter the last digits
name_longlat <- read.csv("coords/YMF2018_RASYpopgen_sampleinfo.csv", as.is = TRUE)[,c(1,3,6,13:14)]

#shuffle column names to include trim name that match to name_longlat "extract" elements


```

```{r}
#import
pilot.loci <- pegas::read.vcf("./input/rasy_ymf_main.vcf", from = 10000, to = 10999)
```

### TreeMix


